{% extends "hiking/layout.html" %}
{% load static %}
{% block title %}User Login{% endblock %}

{% block content %}
  <header>
    <h1>Hello! Sign in to Penny's Pet Rescue</h1>
  </header>

  <main>
    <h2>User Login</h2>

    {# show server-side messages #}
    {% if messages %}
      <ul class="messages">
        {% for m in messages %}
          <li>{{ m }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <form id="loginForm" action="{% url 'hiking:user_login' %}" method="post" novalidate>
      {% csrf_token %}

      <label for="email">Email:</label>
      <input
        type="email"
        id="email"
        name="email"
        placeholder="you@gmail.com"
        required
      >
      <div id="emailError" class="error" style="display:none;"></div>

      <br><br>

      <label for="password">Password:</label>
      <input type="password" id="password" name="password" required>
      <div id="passwordError" class="error" style="display:none;"></div>

      <br><br>

      <a href="{% url 'hiking:password_reset' %}">Forgot password?</a>
      <br><br>

      <input type="submit" value="Login">
      <a href="{% url 'hiking:user_registration' %}" class="btn">Create Account</a>
    </form>
  </main>

  <script>
    // Optional light client-side checks; do NOT block valid submits.
    const form = document.getElementById('loginForm');
    const email = document.getElementById('email');
    const pwd = document.getElementById('password');
    const emailErr = document.getElementById('emailError');
    const pwdErr = document.getElementById('passwordError');

    form.addEventListener('submit', function (e) {
      let ok = true;
      emailErr.style.display = 'none';
      pwdErr.style.display = 'none';

      if (!email.value) {
        emailErr.textContent = 'Email is required.';
        emailErr.style.display = 'block';
        ok = false;
      } else if (!email.checkValidity()) {
        emailErr.textContent = 'Please enter a valid email address.';
        emailErr.style.display = 'block';
        ok = false;
      }
      if (!pwd.value) {
        pwdErr.textContent = 'Password is required.';
        pwdErr.style.display = 'block';
        ok = false;
      }

      if (!ok) e.preventDefault(); 
    });
  </script>
{% endblock %}
